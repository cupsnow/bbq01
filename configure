. .builder/func.sh

BOARD=qemu

help() {
cat <<EOF
  USAGE
    $0 [OPTION]

  OPTION
    -h, --help           Show this help
    -b, --board=[BOARD]  Choose system [$BOARD]

  BOARD
    qemu   For qemu arm simultor
    bb     For beagleboard xm

EOF
}

# LOG_LEVEL=3 # available max log level, 3: debug, 2: info

log_debug "Start parse option"
parse_arg=
for i in $@; do
  if [ -n "$parse_arg" ]; then
    log_verbose "Of option: $parse_arg, Argument: $i"
    opt=$parse_arg
    arg=$i
  else
    opt=$i
  fi

  case "$opt" in
  -h | --help)
    help $0
    exit 0
    ;;
  -b)
    if [ -n "$parse_arg" ]; then
      BOARD=$arg
      parse_arg=
    else
      parse_arg=$opt
    fi
    ;;
  --board=*)
    BOARD=${opt#--board=}
    ;;
  *)
    log_error "Unknown argument $opt" 
    exit 1
    ;;
  esac
done

# empty config.mk
echo -n "" > config.mk

log_info "Set BOARD=$BOARD"
echo "BOARD=$BOARD" >> config.mk
